<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jiaxuan Li, Ridhi Kashyap">
<meta name="dcterms.date" content="2025-07-03">

<title>Tutorial 3: Retrieving digital gender gaps estimates from DGG web API</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="tutorial3_dgg_api_files/libs/clipboard/clipboard.min.js"></script>
<script src="tutorial3_dgg_api_files/libs/quarto-html/quarto.js"></script>
<script src="tutorial3_dgg_api_files/libs/quarto-html/popper.min.js"></script>
<script src="tutorial3_dgg_api_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="tutorial3_dgg_api_files/libs/quarto-html/anchor.min.js"></script>
<link href="tutorial3_dgg_api_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tutorial3_dgg_api_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="tutorial3_dgg_api_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="tutorial3_dgg_api_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="tutorial3_dgg_api_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tutorial 3: Retrieving digital gender gaps estimates from DGG web API</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jiaxuan Li, Ridhi Kashyap </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 3, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="retrieving-digital-gender-gaps-estimates-from-dgg-web-api" class="level1">
<h1>Retrieving digital gender gaps estimates from DGG web API</h1>
<p>In this part of the tutorial, we demonstrate how to access and retrieve digital gender gap indicators generated from the <a href="https://www.digitalgendergaps.org/">Digital Gender Gaps projects</a> using our web API. This API provides a way to automate data requests for individual countries, specific dates, or bulk downloads.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Uncomment below line if you haven't installed relevant packages </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tidyverse")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("httr")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("jsonlite")</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("countrycode")</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("sf")</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("rnaturalearth")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("rnaturalearthdata")</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("cowplot")</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("scales")</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggpubr")</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.4.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tibble' was built under R version 4.4.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'purrr' was built under R version 4.4.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lubridate' was built under R version 4.4.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'jsonlite' was built under R version 4.4.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(countrycode)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'countrycode' was built under R version 4.4.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'sf' was built under R version 4.4.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearthdata)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'scales' was built under R version 4.4.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="retrieving-national-level-digital-gender-gaps-with-dates" class="level2">
<h2 class="anchored" data-anchor-id="retrieving-national-level-digital-gender-gaps-with-dates">1 Retrieving national-level digital gender gaps (with dates)</h2>
<section id="single-country-download" class="level3">
<h3 class="anchored" data-anchor-id="single-country-download">1.1 Single country download</h3>
<p>In this example, we request data for Côte d’Ivoire (country code: CIV) between January 2019 and January 2024. The API returns a nested JSON structure, where each entry is organized by date and contains multiple indicators (such as <code>mobile_men</code>, <code>internet_fm_ratio</code>, etc.), each with a predicted value and an associated error estimate.</p>
<p>To make this data usable for statistical analysis or visualization, we use R’s <code>purrr::map_dfr()</code> to flatten the nested list into a single data frame, where each row represents a unique combination of date and indicator.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">GET</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="fu">paste0</span>(<span class="st">"http://3.11.85.207/api/v2/download_national_data_with_dates"</span>),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">query =</span> <span class="fu">list</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_date =</span> <span class="st">"2019-01"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_date =</span> <span class="st">"2024-01"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">country =</span> <span class="st">"CIV"</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse the response from the API as a list</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">content</span>(response, <span class="at">as =</span> <span class="st">"parsed"</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>civ_df <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">names</span>(data), <span class="cf">function</span>(country) {</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  country_data <span class="ot">&lt;-</span> data[[country]]</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(<span class="fu">names</span>(country_data), <span class="cf">function</span>(date) {</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    indicators <span class="ot">&lt;-</span> country_data[[date]]</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_dfr</span>(<span class="fu">names</span>(indicators), <span class="cf">function</span>(ind) {</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>      entry <span class="ot">&lt;-</span> indicators[[ind]]</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>(</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">gid_0 =</span> country,</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">date =</span> date,</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">indicator =</span> ind,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">predicted =</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(entry<span class="sc">$</span>predicted)) entry<span class="sc">$</span>predicted <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">predicted_error =</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(entry<span class="sc">$</span>predicted_error)) entry<span class="sc">$</span>predicted_error <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>civ_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    gid_0    date         indicator predicted predicted_error
1     CIV 2019-01        mobile_men     0.863           0.067
2     CIV 2019-01 internet_fm_ratio     0.581           0.072
3     CIV 2019-01      mobile_women     0.673           0.074
4     CIV 2019-01    internet_women     0.289           0.078
5     CIV 2019-01   mobile_fm_ratio     0.777           0.057
6     CIV 2019-01      internet_men     0.457           0.076
7     CIV 2019-02      internet_men     0.460           0.076
8     CIV 2019-02   mobile_fm_ratio     0.777           0.057
9     CIV 2019-02      mobile_women     0.676           0.074
10    CIV 2019-02 internet_fm_ratio     0.581           0.072
11    CIV 2019-02    internet_women     0.291           0.078
12    CIV 2019-02        mobile_men     0.866           0.067
13    CIV 2019-03      internet_men     0.455           0.076
14    CIV 2019-03   mobile_fm_ratio     0.776           0.057
15    CIV 2019-03 internet_fm_ratio     0.579           0.072
16    CIV 2019-03      mobile_women     0.671           0.074
17    CIV 2019-03    internet_women     0.287           0.078
18    CIV 2019-03        mobile_men     0.861           0.067
19    CIV 2019-04        mobile_men     0.855           0.067
20    CIV 2019-04 internet_fm_ratio     0.572           0.072
21    CIV 2019-04    internet_women     0.282           0.078
22    CIV 2019-04      internet_men     0.448           0.076
23    CIV 2019-04   mobile_fm_ratio     0.771           0.057
24    CIV 2019-04      mobile_women     0.663           0.074
25    CIV 2019-05      mobile_women     0.654           0.074
26    CIV 2019-05        mobile_men     0.848           0.067
27    CIV 2019-05    internet_women     0.275           0.078
28    CIV 2019-05 internet_fm_ratio     0.565           0.072
29    CIV 2019-05      internet_men     0.440           0.076
30    CIV 2019-05   mobile_fm_ratio     0.767           0.057
31    CIV 2019-06      mobile_women     0.652           0.074
32    CIV 2019-06        mobile_men     0.846           0.067
33    CIV 2019-06 internet_fm_ratio     0.562           0.072
34    CIV 2019-06    internet_women     0.274           0.078
35    CIV 2019-06      internet_men     0.438           0.076
36    CIV 2019-06   mobile_fm_ratio     0.765           0.057
37    CIV 2019-07      mobile_women     0.654           0.074
38    CIV 2019-07        mobile_men     0.847           0.067
39    CIV 2019-07    internet_women     0.275           0.078
40    CIV 2019-07 internet_fm_ratio     0.566           0.072
41    CIV 2019-07      internet_men     0.440           0.076
42    CIV 2019-07   mobile_fm_ratio     0.767           0.057
43    CIV 2019-08        mobile_men     0.848           0.067
44    CIV 2019-08 internet_fm_ratio     0.569           0.072
45    CIV 2019-08    internet_women     0.277           0.078
46    CIV 2019-08      internet_men     0.441           0.076
47    CIV 2019-08   mobile_fm_ratio     0.769           0.057
48    CIV 2019-08      mobile_women     0.656           0.074
49    CIV 2019-09        mobile_men     0.848           0.067
50    CIV 2019-09   mobile_fm_ratio     0.770           0.057
51    CIV 2019-09      mobile_women     0.656           0.074
52    CIV 2019-09      internet_men     0.440           0.076
53    CIV 2019-09    internet_women     0.277           0.078
54    CIV 2019-09 internet_fm_ratio     0.570           0.072
55    CIV 2019-10 internet_fm_ratio     0.570           0.072
56    CIV 2019-10        mobile_men     0.850           0.067
57    CIV 2019-10      mobile_women     0.658           0.074
58    CIV 2019-10      internet_men     0.442           0.076
59    CIV 2019-10    internet_women     0.278           0.078
60    CIV 2019-10   mobile_fm_ratio     0.770           0.057
61    CIV 2019-11        mobile_men     0.852           0.067
62    CIV 2019-11 internet_fm_ratio     0.571           0.072
63    CIV 2019-11    internet_women     0.280           0.078
64    CIV 2019-11      internet_men     0.445           0.076
65    CIV 2019-11   mobile_fm_ratio     0.771           0.057
66    CIV 2019-11      mobile_women     0.661           0.074
67    CIV 2019-12    internet_women     0.281           0.078
68    CIV 2019-12        mobile_men     0.854           0.067
69    CIV 2019-12      mobile_women     0.662           0.074
70    CIV 2019-12   mobile_fm_ratio     0.771           0.057
71    CIV 2019-12      internet_men     0.447           0.076
72    CIV 2019-12 internet_fm_ratio     0.571           0.072
73    CIV 2020-01 internet_fm_ratio     0.592           0.073
74    CIV 2020-01    internet_women     0.311           0.079
75    CIV 2020-01      internet_men     0.472           0.076
76    CIV 2020-01   mobile_fm_ratio     0.783           0.057
77    CIV 2020-01      mobile_women     0.675           0.075
78    CIV 2020-01        mobile_men     0.856           0.068
79    CIV 2020-02 internet_fm_ratio     0.593           0.073
80    CIV 2020-02        mobile_men     0.856           0.068
81    CIV 2020-02      mobile_women     0.676           0.075
82    CIV 2020-02   mobile_fm_ratio     0.784           0.057
83    CIV 2020-02      internet_men     0.472           0.076
84    CIV 2020-02    internet_women     0.312           0.079
85    CIV 2020-03      mobile_women     0.679           0.075
86    CIV 2020-03        mobile_men     0.858           0.068
87    CIV 2020-03      internet_men     0.474           0.076
88    CIV 2020-03 internet_fm_ratio     0.597           0.073
89    CIV 2020-03    internet_women     0.314           0.079
90    CIV 2020-03   mobile_fm_ratio     0.786           0.057
91    CIV 2020-04 internet_fm_ratio     0.603           0.073
92    CIV 2020-04        mobile_men     0.860           0.068
93    CIV 2020-04   mobile_fm_ratio     0.790           0.057
94    CIV 2020-04      internet_men     0.476           0.076
95    CIV 2020-04    internet_women     0.317           0.079
96    CIV 2020-04      mobile_women     0.683           0.075
97    CIV 2020-05      internet_men     0.477           0.076
98    CIV 2020-05 internet_fm_ratio     0.605           0.073
99    CIV 2020-05    internet_women     0.318           0.079
100   CIV 2020-05   mobile_fm_ratio     0.791           0.057
101   CIV 2020-05      mobile_women     0.684           0.075
102   CIV 2020-05        mobile_men     0.860           0.068
103   CIV 2020-06    internet_women     0.318           0.079
104   CIV 2020-06 internet_fm_ratio     0.606           0.073
105   CIV 2020-06        mobile_men     0.860           0.068
106   CIV 2020-06      mobile_women     0.684           0.075
107   CIV 2020-06   mobile_fm_ratio     0.792           0.057
108   CIV 2020-06      internet_men     0.476           0.076
109   CIV 2020-07    internet_women     0.318           0.079
110   CIV 2020-07        mobile_men     0.860           0.068
111   CIV 2020-07 internet_fm_ratio     0.606           0.073
112   CIV 2020-07      mobile_women     0.684           0.075
113   CIV 2020-07      internet_men     0.476           0.076
114   CIV 2020-07   mobile_fm_ratio     0.792           0.057
115   CIV 2020-08 internet_fm_ratio     0.608           0.073
116   CIV 2020-08    internet_women     0.318           0.079
117   CIV 2020-08      internet_men     0.476           0.076
118   CIV 2020-08   mobile_fm_ratio     0.793           0.057
119   CIV 2020-08      mobile_women     0.684           0.075
120   CIV 2020-08        mobile_men     0.860           0.068
121   CIV 2020-09   mobile_fm_ratio     0.794           0.057
122   CIV 2020-09      mobile_women     0.685           0.075
123   CIV 2020-09        mobile_men     0.860           0.068
124   CIV 2020-09 internet_fm_ratio     0.611           0.073
125   CIV 2020-09    internet_women     0.319           0.079
126   CIV 2020-09      internet_men     0.477           0.076
127   CIV 2020-10        mobile_men     0.860           0.068
128   CIV 2020-10      mobile_women     0.687           0.075
129   CIV 2020-10      internet_men     0.478           0.076
130   CIV 2020-10   mobile_fm_ratio     0.796           0.057
131   CIV 2020-10    internet_women     0.320           0.079
132   CIV 2020-10 internet_fm_ratio     0.613           0.073
133   CIV 2020-11 internet_fm_ratio     0.616           0.073
134   CIV 2020-11        mobile_men     0.864           0.068
135   CIV 2020-11      mobile_women     0.691           0.075
136   CIV 2020-11   mobile_fm_ratio     0.798           0.057
137   CIV 2020-11      internet_men     0.481           0.076
138   CIV 2020-11    internet_women     0.323           0.079
139   CIV 2020-12   mobile_fm_ratio     0.799           0.057
140   CIV 2020-12        mobile_men     0.865           0.068
141   CIV 2020-12 internet_fm_ratio     0.619           0.073
142   CIV 2020-12      mobile_women     0.693           0.075
143   CIV 2020-12    internet_women     0.325           0.079
144   CIV 2020-12      internet_men     0.483           0.076
145   CIV 2021-01 internet_fm_ratio     0.630           0.073
146   CIV 2021-01        mobile_men     0.879           0.068
147   CIV 2021-01      mobile_women     0.710           0.075
148   CIV 2021-01   mobile_fm_ratio     0.806           0.057
149   CIV 2021-01      internet_men     0.508           0.076
150   CIV 2021-01    internet_women     0.349           0.079
151   CIV 2021-02      mobile_women     0.709           0.075
152   CIV 2021-02 internet_fm_ratio     0.632           0.073
153   CIV 2021-02        mobile_men     0.878           0.068
154   CIV 2021-02    internet_women     0.349           0.079
155   CIV 2021-02      internet_men     0.507           0.076
156   CIV 2021-02   mobile_fm_ratio     0.807           0.057
157   CIV 2021-03      mobile_women     0.711           0.075
158   CIV 2021-03 internet_fm_ratio     0.633           0.073
159   CIV 2021-03        mobile_men     0.879           0.068
160   CIV 2021-03    internet_women     0.351           0.079
161   CIV 2021-03      internet_men     0.508           0.076
162   CIV 2021-03   mobile_fm_ratio     0.808           0.057
163   CIV 2021-04   mobile_fm_ratio     0.811           0.057
164   CIV 2021-04      mobile_women     0.713           0.075
165   CIV 2021-04        mobile_men     0.880           0.068
166   CIV 2021-04 internet_fm_ratio     0.638           0.073
167   CIV 2021-04    internet_women     0.353           0.079
168   CIV 2021-04      internet_men     0.510           0.076
169   CIV 2021-05      mobile_women     0.717           0.075
170   CIV 2021-05        mobile_men     0.883           0.068
171   CIV 2021-05   mobile_fm_ratio     0.812           0.057
172   CIV 2021-05      internet_men     0.513           0.076
173   CIV 2021-05    internet_women     0.355           0.079
174   CIV 2021-05 internet_fm_ratio     0.640           0.073
175   CIV 2021-06        mobile_men     0.884           0.068
176   CIV 2021-06      mobile_women     0.719           0.075
177   CIV 2021-06   mobile_fm_ratio     0.814           0.057
178   CIV 2021-06      internet_men     0.515           0.076
179   CIV 2021-06    internet_women     0.357           0.079
180   CIV 2021-06 internet_fm_ratio     0.643           0.073
181   CIV 2021-07        mobile_men     0.884           0.068
182   CIV 2021-07      mobile_women     0.720           0.075
183   CIV 2021-07   mobile_fm_ratio     0.815           0.057
184   CIV 2021-07      internet_men     0.516           0.076
185   CIV 2021-07    internet_women     0.358           0.079
186   CIV 2021-07 internet_fm_ratio     0.644           0.073
187   CIV 2021-08    internet_women     0.358           0.079
188   CIV 2021-08        mobile_men     0.884           0.068
189   CIV 2021-08      mobile_women     0.720           0.075
190   CIV 2021-08   mobile_fm_ratio     0.816           0.057
191   CIV 2021-08      internet_men     0.516           0.076
192   CIV 2021-08 internet_fm_ratio     0.646           0.073
193   CIV 2021-09 internet_fm_ratio     0.648           0.073
194   CIV 2021-09        mobile_men     0.883           0.068
195   CIV 2021-09      mobile_women     0.720           0.075
196   CIV 2021-09   mobile_fm_ratio     0.817           0.057
197   CIV 2021-09      internet_men     0.515           0.076
198   CIV 2021-09    internet_women     0.359           0.079
199   CIV 2021-10      internet_men     0.515           0.076
200   CIV 2021-10        mobile_men     0.883           0.068
201   CIV 2021-10 internet_fm_ratio     0.649           0.073
202   CIV 2021-10    internet_women     0.358           0.079
203   CIV 2021-10      mobile_women     0.720           0.075
204   CIV 2021-10   mobile_fm_ratio     0.817           0.057
205   CIV 2021-11      mobile_women     0.720           0.075
206   CIV 2021-11    internet_women     0.359           0.079
207   CIV 2021-11 internet_fm_ratio     0.650           0.073
208   CIV 2021-11      internet_men     0.514           0.076
209   CIV 2021-11   mobile_fm_ratio     0.818           0.057
210   CIV 2021-11        mobile_men     0.882           0.068
211   CIV 2021-12    internet_women     0.360           0.079
212   CIV 2021-12      mobile_women     0.721           0.075
213   CIV 2021-12   mobile_fm_ratio     0.819           0.057
214   CIV 2021-12        mobile_men     0.883           0.068
215   CIV 2021-12      internet_men     0.516           0.076
216   CIV 2021-12 internet_fm_ratio     0.651           0.073
217   CIV 2022-01      internet_men     0.537           0.077
218   CIV 2022-01 internet_fm_ratio     0.662           0.073
219   CIV 2022-01    internet_women     0.383           0.079
220   CIV 2022-01   mobile_fm_ratio     0.824           0.057
221   CIV 2022-01      mobile_women     0.726           0.075
222   CIV 2022-01        mobile_men     0.885           0.068
223   CIV 2022-02      mobile_women     0.726           0.075
224   CIV 2022-02        mobile_men     0.885           0.068
225   CIV 2022-02   mobile_fm_ratio     0.823           0.057
226   CIV 2022-02    internet_women     0.382           0.079
227   CIV 2022-02 internet_fm_ratio     0.660           0.073
228   CIV 2022-02      internet_men     0.537           0.077
229   CIV 2022-03      internet_men     0.538           0.077
230   CIV 2022-03 internet_fm_ratio     0.662           0.073
231   CIV 2022-03        mobile_men     0.886           0.068
232   CIV 2022-03      mobile_women     0.726           0.075
233   CIV 2022-03   mobile_fm_ratio     0.824           0.057
234   CIV 2022-03    internet_women     0.383           0.079
235   CIV 2022-04 internet_fm_ratio     0.664           0.073
236   CIV 2022-04        mobile_men     0.888           0.068
237   CIV 2022-04      mobile_women     0.729           0.075
238   CIV 2022-04   mobile_fm_ratio     0.825           0.057
239   CIV 2022-04      internet_men     0.540           0.077
240   CIV 2022-04    internet_women     0.385           0.079
241   CIV 2022-05 internet_fm_ratio     0.663           0.073
242   CIV 2022-05   mobile_fm_ratio     0.824           0.057
243   CIV 2022-05      mobile_women     0.728           0.075
244   CIV 2022-05        mobile_men     0.887           0.068
245   CIV 2022-05      internet_men     0.539           0.077
246   CIV 2022-05    internet_women     0.385           0.079
247   CIV 2022-06 internet_fm_ratio     0.665           0.073
248   CIV 2022-06      mobile_women     0.730           0.075
249   CIV 2022-06   mobile_fm_ratio     0.826           0.057
250   CIV 2022-06      internet_men     0.541           0.077
251   CIV 2022-06    internet_women     0.386           0.079
252   CIV 2022-06        mobile_men     0.888           0.068
253   CIV 2022-07    internet_women     0.387           0.079
254   CIV 2022-07   mobile_fm_ratio     0.827           0.057
255   CIV 2022-07        mobile_men     0.888           0.068
256   CIV 2022-07      mobile_women     0.730           0.075
257   CIV 2022-07 internet_fm_ratio     0.667           0.073
258   CIV 2022-07      internet_men     0.541           0.077
259   CIV 2022-08 internet_fm_ratio     0.667           0.073
260   CIV 2022-08        mobile_men     0.888           0.068
261   CIV 2022-08   mobile_fm_ratio     0.827           0.057
262   CIV 2022-08      internet_men     0.541           0.077
263   CIV 2022-08      mobile_women     0.730           0.075
264   CIV 2022-08    internet_women     0.387           0.079
265   CIV 2022-09    internet_women     0.380           0.079
266   CIV 2022-09 internet_fm_ratio     0.660           0.073
267   CIV 2022-09      internet_men     0.534           0.077
268   CIV 2022-09      mobile_women     0.723           0.075
269   CIV 2022-09   mobile_fm_ratio     0.822           0.057
270   CIV 2022-09        mobile_men     0.882           0.068
271   CIV 2022-10      mobile_women     0.715           0.075
272   CIV 2022-10        mobile_men     0.876           0.068
273   CIV 2022-10 internet_fm_ratio     0.652           0.073
274   CIV 2022-10    internet_women     0.374           0.079
275   CIV 2022-10      internet_men     0.526           0.077
276   CIV 2022-10   mobile_fm_ratio     0.817           0.057
277   CIV 2022-11        mobile_men     0.870           0.068
278   CIV 2022-11    internet_women     0.367           0.079
279   CIV 2022-11      internet_men     0.519           0.077
280   CIV 2022-11   mobile_fm_ratio     0.812           0.057
281   CIV 2022-11      mobile_women     0.707           0.075
282   CIV 2022-11 internet_fm_ratio     0.645           0.073
283   CIV 2022-12        mobile_men     0.867           0.068
284   CIV 2022-12      internet_men     0.515           0.077
285   CIV 2022-12    internet_women     0.363           0.079
286   CIV 2022-12 internet_fm_ratio     0.639           0.073
287   CIV 2022-12   mobile_fm_ratio     0.809           0.057
288   CIV 2022-12      mobile_women     0.702           0.075
289   CIV 2023-01      mobile_women     0.703           0.075
290   CIV 2023-01 internet_fm_ratio     0.643           0.073
291   CIV 2023-01    internet_women     0.378           0.079
292   CIV 2023-01      internet_men     0.528           0.077
293   CIV 2023-01   mobile_fm_ratio     0.810           0.057
294   CIV 2023-01        mobile_men     0.867           0.068
295   CIV 2023-02 internet_fm_ratio     0.645           0.073
296   CIV 2023-02        mobile_men     0.868           0.068
297   CIV 2023-02      mobile_women     0.704           0.075
298   CIV 2023-02   mobile_fm_ratio     0.811           0.057
299   CIV 2023-02      internet_men     0.529           0.077
300   CIV 2023-02    internet_women     0.379           0.079
301   CIV 2023-03        mobile_men     0.874           0.068
302   CIV 2023-03 internet_fm_ratio     0.652           0.073
303   CIV 2023-03    internet_women     0.386           0.079
304   CIV 2023-03      internet_men     0.537           0.077
305   CIV 2023-03   mobile_fm_ratio     0.816           0.057
306   CIV 2023-03      mobile_women     0.712           0.075
307   CIV 2023-04 internet_fm_ratio     0.669           0.073
308   CIV 2023-04        mobile_men     0.888           0.068
309   CIV 2023-04      mobile_women     0.730           0.075
310   CIV 2023-04   mobile_fm_ratio     0.826           0.057
311   CIV 2023-04      internet_men     0.554           0.077
312   CIV 2023-04    internet_women     0.401           0.079
313   CIV 2023-05 internet_fm_ratio     0.681           0.073
314   CIV 2023-05      internet_men     0.568           0.077
315   CIV 2023-05   mobile_fm_ratio     0.834           0.057
316   CIV 2023-05      mobile_women     0.744           0.075
317   CIV 2023-05        mobile_men     0.899           0.068
318   CIV 2023-05    internet_women     0.412           0.079
319   CIV 2023-06   mobile_fm_ratio     0.837           0.057
320   CIV 2023-06 internet_fm_ratio     0.685           0.073
321   CIV 2023-06        mobile_men     0.903           0.068
322   CIV 2023-06      mobile_women     0.749           0.075
323   CIV 2023-06      internet_men     0.572           0.077
324   CIV 2023-06    internet_women     0.416           0.079
325   CIV 2023-07 internet_fm_ratio     0.656           0.073
326   CIV 2023-07        mobile_men     0.875           0.068
327   CIV 2023-07      internet_men     0.538           0.077
328   CIV 2023-07   mobile_fm_ratio     0.818           0.057
329   CIV 2023-07    internet_women     0.388           0.079
330   CIV 2023-07      mobile_women     0.715           0.075
331   CIV 2023-08        mobile_men     0.873           0.068
332   CIV 2023-08    internet_women     0.386           0.079
333   CIV 2023-08      internet_men     0.536           0.077
334   CIV 2023-08   mobile_fm_ratio     0.818           0.057
335   CIV 2023-08      mobile_women     0.713           0.075
336   CIV 2023-08 internet_fm_ratio     0.655           0.073
337   CIV 2023-09        mobile_men     0.875           0.068
338   CIV 2023-09      mobile_women     0.716           0.075
339   CIV 2023-09   mobile_fm_ratio     0.820           0.057
340   CIV 2023-09      internet_men     0.539           0.077
341   CIV 2023-09    internet_women     0.389           0.079
342   CIV 2023-09 internet_fm_ratio     0.659           0.073
343   CIV 2023-10      internet_men     0.559           0.077
344   CIV 2023-10   mobile_fm_ratio     0.830           0.057
345   CIV 2023-10 internet_fm_ratio     0.674           0.073
346   CIV 2023-10    internet_women     0.405           0.079
347   CIV 2023-10        mobile_men     0.891           0.068
348   CIV 2023-10      mobile_women     0.735           0.075
349   CIV 2023-11    internet_women     0.379           0.079
350   CIV 2023-11      mobile_women     0.704           0.075
351   CIV 2023-11   mobile_fm_ratio     0.813           0.057
352   CIV 2023-11        mobile_men     0.867           0.068
353   CIV 2023-11 internet_fm_ratio     0.648           0.073
354   CIV 2023-11      internet_men     0.528           0.077
355   CIV 2023-12        mobile_men     0.873           0.068
356   CIV 2023-12 internet_fm_ratio     0.653           0.073
357   CIV 2023-12    internet_women     0.385           0.079
358   CIV 2023-12      internet_men     0.536           0.077
359   CIV 2023-12   mobile_fm_ratio     0.816           0.057
360   CIV 2023-12      mobile_women     0.712           0.075
361   CIV 2024-01 internet_fm_ratio     0.683           0.073
362   CIV 2024-01    internet_women     0.424           0.079
363   CIV 2024-01      internet_men     0.577           0.077
364   CIV 2024-01        mobile_men     0.896           0.068
365   CIV 2024-01   mobile_fm_ratio     0.834           0.057
366   CIV 2024-01      mobile_women     0.742           0.075</code></pre>
</div>
</div>
</section>
<section id="multiple-countries-download" class="level3">
<h3 class="anchored" data-anchor-id="multiple-countries-download">1.2 Multiple countries download</h3>
<p>In this section, we demonstrate how to automate the download and parsing process for multiple countries using R. Since we cannot directly pass a country-code vector to the argument, we will use a <code>for</code> loop to iterate over a vector of ISO3 country codes, send an API request for each one, and parse the nested JSON response into a tidy, unified data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector of ISO3 country codes (countries that we are interested in)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"AFG"</span>, <span class="st">"BRA"</span>, <span class="st">"COD"</span>, <span class="st">"FRA"</span>,<span class="st">"IND"</span>, <span class="st">"JPN"</span>, <span class="st">"NGA"</span>, <span class="st">"SAU"</span>, <span class="st">"SWE"</span>,<span class="st">"USA"</span>, <span class="st">"ZAF"</span>) </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize empty list to store all country results</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each country</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (code <span class="cf">in</span> countries) {</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make API request for each country</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  response <span class="ot">&lt;-</span> <span class="fu">GET</span>(</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">url =</span> <span class="st">"http://3.11.85.207/api/v2/download_national_data_with_dates"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">query =</span> <span class="fu">list</span>(</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">start_date =</span> <span class="st">"2023-01"</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">end_date =</span> <span class="st">"2024-01"</span>,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">country =</span> code</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If request is successful</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">status_code</span>(response) <span class="sc">==</span> <span class="dv">200</span>) {</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parse response as structured list</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">content</span>(response, <span class="at">as =</span> <span class="st">"parsed"</span>)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if data exists for the country</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(data[[code]])) {</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Flatten JSON: loop over dates and indicators</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>      df <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">names</span>(data[[code]]), <span class="cf">function</span>(date) {</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>        indicators <span class="ot">&lt;-</span> data[[code]][[date]]</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>        <span class="fu">map_dfr</span>(<span class="fu">names</span>(indicators), <span class="cf">function</span>(ind) {</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>          entry <span class="ot">&lt;-</span> indicators[[ind]]</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>          <span class="fu">data.frame</span>(</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">date =</span> date,</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">indicator =</span> ind,</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">predicted =</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(entry<span class="sc">$</span>predicted)) entry<span class="sc">$</span>predicted <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">predicted_error =</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(entry<span class="sc">$</span>predicted_error)) entry<span class="sc">$</span>predicted_error <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">gid_0 =</span> code,</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>      all_data[[code]] <span class="ot">&lt;-</span> df</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">"No data for country:"</span>, code))</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">"Request failed for country:"</span>, code))</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>selected_countries_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(all_data)</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>selected_countries_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       date         indicator predicted predicted_error gid_0
1   2023-01      mobile_women     0.306           0.054   AFG
2   2023-01        mobile_men     0.776           0.049   AFG
3   2023-01   mobile_fm_ratio     0.448           0.041   AFG
4   2023-01      internet_men     0.235           0.055   AFG
5   2023-01    internet_women        NA           0.057   AFG
6   2023-01 internet_fm_ratio     0.107           0.053   AFG
7   2023-02 internet_fm_ratio     0.107           0.053   AFG
8   2023-02    internet_women        NA           0.057   AFG
9   2023-02      internet_men     0.235           0.055   AFG
10  2023-02   mobile_fm_ratio     0.448           0.041   AFG
11  2023-02      mobile_women     0.306           0.054   AFG
12  2023-02        mobile_men     0.776           0.049   AFG
13  2023-03        mobile_men     0.781           0.049   AFG
14  2023-03 internet_fm_ratio     0.112           0.053   AFG
15  2023-03    internet_women        NA           0.057   AFG
16  2023-03      internet_men     0.240           0.055   AFG
17  2023-03   mobile_fm_ratio     0.451           0.041   AFG
18  2023-03      mobile_women     0.312           0.054   AFG
19  2023-04 internet_fm_ratio     0.127           0.053   AFG
20  2023-04    internet_women        NA           0.057   AFG
21  2023-04      internet_men     0.253           0.055   AFG
22  2023-04   mobile_fm_ratio     0.460           0.041   AFG
23  2023-04      mobile_women     0.329           0.054   AFG
24  2023-04        mobile_men     0.795           0.049   AFG
25  2023-05      mobile_women     0.345           0.054   AFG
26  2023-05    internet_women        NA           0.057   AFG
27  2023-05        mobile_men     0.808           0.049   AFG
28  2023-05 internet_fm_ratio     0.141           0.053   AFG
29  2023-05      internet_men     0.266           0.055   AFG
30  2023-05   mobile_fm_ratio     0.469           0.041   AFG
31  2023-06      mobile_women     0.353           0.054   AFG
32  2023-06 internet_fm_ratio     0.147           0.053   AFG
33  2023-06    internet_women        NA           0.057   AFG
34  2023-06      internet_men     0.272           0.055   AFG
35  2023-06   mobile_fm_ratio     0.472           0.041   AFG
36  2023-06        mobile_men     0.815           0.049   AFG
37  2023-07      mobile_women     0.310           0.054   AFG
38  2023-07    internet_women        NA           0.057   AFG
39  2023-07 internet_fm_ratio     0.110           0.053   AFG
40  2023-07      internet_men     0.238           0.055   AFG
41  2023-07   mobile_fm_ratio     0.449           0.041   AFG
42  2023-07        mobile_men     0.779           0.049   AFG
43  2023-08      internet_men     0.236           0.055   AFG
44  2023-08        mobile_men     0.777           0.049   AFG
45  2023-08 internet_fm_ratio     0.108           0.053   AFG
46  2023-08      mobile_women     0.307           0.054   AFG
47  2023-08   mobile_fm_ratio     0.448           0.041   AFG
48  2023-08    internet_women        NA           0.057   AFG
49  2023-09    internet_women        NA           0.057   AFG
50  2023-09 internet_fm_ratio     0.110           0.053   AFG
51  2023-09      internet_men     0.238           0.055   AFG
52  2023-09   mobile_fm_ratio     0.449           0.041   AFG
53  2023-09      mobile_women     0.309           0.054   AFG
54  2023-09        mobile_men     0.779           0.049   AFG
55  2023-10 internet_fm_ratio     0.129           0.053   AFG
56  2023-10      mobile_women     0.333           0.054   AFG
57  2023-10   mobile_fm_ratio     0.461           0.041   AFG
58  2023-10        mobile_men     0.799           0.049   AFG
59  2023-10      internet_men     0.257           0.055   AFG
60  2023-10    internet_women        NA           0.057   AFG
61  2023-11      internet_men     0.224           0.055   AFG
62  2023-11    internet_women        NA           0.057   AFG
63  2023-11 internet_fm_ratio     0.095           0.053   AFG
64  2023-11   mobile_fm_ratio     0.440           0.041   AFG
65  2023-11      mobile_women     0.292           0.054   AFG
66  2023-11        mobile_men     0.764           0.049   AFG
67  2023-12        mobile_men     0.769           0.049   AFG
68  2023-12      mobile_women     0.298           0.054   AFG
69  2023-12   mobile_fm_ratio     0.443           0.041   AFG
70  2023-12    internet_women        NA           0.057   AFG
71  2023-12 internet_fm_ratio     0.100           0.053   AFG
72  2023-12      internet_men     0.228           0.055   AFG
73  2024-01      mobile_women     0.330           0.054   AFG
74  2024-01        mobile_men     0.795           0.049   AFG
75  2024-01   mobile_fm_ratio     0.460           0.041   AFG
76  2024-01      internet_men     0.268           0.055   AFG
77  2024-01    internet_women        NA           0.057   AFG
78  2024-01 internet_fm_ratio     0.130           0.053   AFG
79  2023-01        mobile_men     0.828           0.079   BRA
80  2023-01 internet_fm_ratio     1.000           0.085   BRA
81  2023-01    internet_women     0.799           0.091   BRA
82  2023-01      internet_men     0.785           0.089   BRA
83  2023-01   mobile_fm_ratio     1.000           0.067   BRA
84  2023-01      mobile_women     0.867           0.087   BRA
85  2023-02        mobile_men     0.829           0.079   BRA
86  2023-02 internet_fm_ratio     1.000           0.085   BRA
87  2023-02    internet_women     0.799           0.091   BRA
88  2023-02      internet_men     0.786           0.089   BRA
89  2023-02   mobile_fm_ratio     1.000           0.067   BRA
90  2023-02      mobile_women     0.868           0.087   BRA
91  2023-03        mobile_men     0.831           0.079   BRA
92  2023-03      mobile_women     0.869           0.087   BRA
93  2023-03   mobile_fm_ratio     1.000           0.067   BRA
94  2023-03      internet_men     0.787           0.089   BRA
95  2023-03    internet_women     0.799           0.091   BRA
96  2023-03 internet_fm_ratio     1.000           0.085   BRA
97  2023-04 internet_fm_ratio     1.000           0.085   BRA
98  2023-04        mobile_men     0.833           0.079   BRA
99  2023-04      mobile_women     0.872           0.087   BRA
100 2023-04   mobile_fm_ratio     1.000           0.067   BRA
101 2023-04      internet_men     0.791           0.089   BRA
102 2023-04    internet_women     0.802           0.091   BRA
103 2023-05      mobile_women     0.872           0.087   BRA
104 2023-05        mobile_men     0.834           0.079   BRA
105 2023-05    internet_women     0.804           0.091   BRA
106 2023-05 internet_fm_ratio     1.000           0.085   BRA
107 2023-05      internet_men     0.793           0.089   BRA
108 2023-05   mobile_fm_ratio     1.000           0.067   BRA
109 2023-06 internet_fm_ratio     1.000           0.085   BRA
110 2023-06   mobile_fm_ratio     1.000           0.067   BRA
111 2023-06    internet_women     0.806           0.091   BRA
112 2023-06      internet_men     0.795           0.089   BRA
113 2023-06      mobile_women     0.873           0.087   BRA
114 2023-06        mobile_men     0.835           0.079   BRA
115 2023-07    internet_women     0.788           0.091   BRA
116 2023-07        mobile_men     0.843           0.079   BRA
117 2023-07   mobile_fm_ratio     1.000           0.067   BRA
118 2023-07      internet_men     0.783           0.089   BRA
119 2023-07 internet_fm_ratio     1.000           0.085   BRA
120 2023-07      mobile_women     0.879           0.087   BRA
121 2023-08   mobile_fm_ratio     1.000           0.067   BRA
122 2023-08    internet_women     0.788           0.091   BRA
123 2023-08        mobile_men     0.844           0.079   BRA
124 2023-08 internet_fm_ratio     1.000           0.085   BRA
125 2023-08      mobile_women     0.880           0.087   BRA
126 2023-08      internet_men     0.783           0.089   BRA
127 2023-09    internet_women     0.789           0.091   BRA
128 2023-09 internet_fm_ratio     1.000           0.085   BRA
129 2023-09      internet_men     0.784           0.089   BRA
130 2023-09   mobile_fm_ratio     1.000           0.067   BRA
131 2023-09      mobile_women     0.881           0.087   BRA
132 2023-09        mobile_men     0.845           0.079   BRA
133 2023-10 internet_fm_ratio     1.000           0.085   BRA
134 2023-10   mobile_fm_ratio     1.000           0.067   BRA
135 2023-10      mobile_women     0.878           0.087   BRA
136 2023-10        mobile_men     0.842           0.079   BRA
137 2023-10      internet_men     0.791           0.089   BRA
138 2023-10    internet_women     0.797           0.091   BRA
139 2023-11      internet_men     0.778           0.089   BRA
140 2023-11    internet_women     0.779           0.091   BRA
141 2023-11 internet_fm_ratio     1.000           0.085   BRA
142 2023-11   mobile_fm_ratio     1.000           0.067   BRA
143 2023-11      mobile_women     0.885           0.087   BRA
144 2023-11        mobile_men     0.851           0.079   BRA
145 2023-12        mobile_men     0.850           0.079   BRA
146 2023-12      mobile_women     0.884           0.087   BRA
147 2023-12   mobile_fm_ratio     1.000           0.067   BRA
148 2023-12      internet_men     0.778           0.089   BRA
149 2023-12    internet_women     0.779           0.091   BRA
150 2023-12 internet_fm_ratio     1.000           0.085   BRA
151 2024-01      mobile_women     0.888           0.087   BRA
152 2024-01        mobile_men     0.850           0.079   BRA
153 2024-01   mobile_fm_ratio     1.000           0.067   BRA
154 2024-01      internet_men     0.803           0.089   BRA
155 2024-01    internet_women     0.808           0.091   BRA
156 2024-01 internet_fm_ratio     1.000           0.085   BRA
157 2023-01        mobile_men     0.665           0.070   COD
158 2023-01 internet_fm_ratio     0.554           0.075   COD
159 2023-01    internet_women     0.232           0.082   COD
160 2023-01      internet_men     0.351           0.079   COD
161 2023-01   mobile_fm_ratio     0.751           0.059   COD
162 2023-01      mobile_women     0.503           0.078   COD
163 2023-02        mobile_men     0.665           0.070   COD
164 2023-02 internet_fm_ratio     0.554           0.075   COD
165 2023-02    internet_women     0.232           0.082   COD
166 2023-02      internet_men     0.351           0.079   COD
167 2023-02   mobile_fm_ratio     0.751           0.059   COD
168 2023-02      mobile_women     0.503           0.078   COD
169 2023-03        mobile_men     0.667           0.070   COD
170 2023-03      mobile_women     0.506           0.078   COD
171 2023-03   mobile_fm_ratio     0.753           0.059   COD
172 2023-03      internet_men     0.353           0.079   COD
173 2023-03    internet_women     0.234           0.082   COD
174 2023-03 internet_fm_ratio     0.557           0.075   COD
175 2023-04 internet_fm_ratio     0.561           0.075   COD
176 2023-04        mobile_men     0.671           0.070   COD
177 2023-04      mobile_women     0.511           0.078   COD
178 2023-04   mobile_fm_ratio     0.755           0.059   COD
179 2023-04      internet_men     0.358           0.079   COD
180 2023-04    internet_women     0.238           0.082   COD
181 2023-05      mobile_women     0.515           0.078   COD
182 2023-05        mobile_men     0.675           0.070   COD
183 2023-05    internet_women     0.241           0.082   COD
184 2023-05 internet_fm_ratio     0.564           0.075   COD
185 2023-05      internet_men     0.362           0.079   COD
186 2023-05   mobile_fm_ratio     0.757           0.059   COD
187 2023-06 internet_fm_ratio     0.566           0.075   COD
188 2023-06   mobile_fm_ratio     0.758           0.059   COD
189 2023-06    internet_women     0.243           0.082   COD
190 2023-06      internet_men     0.364           0.079   COD
191 2023-06      mobile_women     0.517           0.078   COD
192 2023-06        mobile_men     0.677           0.070   COD
193 2023-07    internet_women     0.233           0.082   COD
194 2023-07        mobile_men     0.667           0.070   COD
195 2023-07   mobile_fm_ratio     0.752           0.059   COD
196 2023-07      internet_men     0.353           0.079   COD
197 2023-07 internet_fm_ratio     0.556           0.075   COD
198 2023-07      mobile_women     0.505           0.078   COD
199 2023-08   mobile_fm_ratio     0.754           0.059   COD
200 2023-08    internet_women     0.234           0.082   COD
201 2023-08        mobile_men     0.667           0.070   COD
202 2023-08 internet_fm_ratio     0.558           0.075   COD
203 2023-08      mobile_women     0.506           0.078   COD
204 2023-08      internet_men     0.353           0.079   COD
205 2023-09 internet_fm_ratio     0.561           0.075   COD
206 2023-09    internet_women     0.236           0.082   COD
207 2023-09      internet_men     0.355           0.079   COD
208 2023-09   mobile_fm_ratio     0.755           0.059   COD
209 2023-09      mobile_women     0.509           0.078   COD
210 2023-09        mobile_men     0.669           0.070   COD
211 2023-10 internet_fm_ratio     0.568           0.075   COD
212 2023-10   mobile_fm_ratio     0.760           0.059   COD
213 2023-10      mobile_women     0.517           0.078   COD
214 2023-10      internet_men     0.362           0.079   COD
215 2023-10        mobile_men     0.675           0.070   COD
216 2023-10    internet_women     0.242           0.082   COD
217 2023-11      internet_men     0.351           0.079   COD
218 2023-11    internet_women     0.233           0.082   COD
219 2023-11 internet_fm_ratio     0.558           0.075   COD
220 2023-11   mobile_fm_ratio     0.754           0.059   COD
221 2023-11      mobile_women     0.505           0.078   COD
222 2023-11        mobile_men     0.666           0.070   COD
223 2023-12        mobile_men     0.667           0.070   COD
224 2023-12      mobile_women     0.507           0.078   COD
225 2023-12   mobile_fm_ratio     0.755           0.059   COD
226 2023-12      internet_men     0.353           0.079   COD
227 2023-12    internet_women     0.234           0.082   COD
228 2023-12 internet_fm_ratio     0.561           0.075   COD
229 2024-01      mobile_women     0.523           0.078   COD
230 2024-01        mobile_men     0.679           0.070   COD
231 2024-01   mobile_fm_ratio     0.764           0.059   COD
232 2024-01      internet_men     0.379           0.079   COD
233 2024-01    internet_women     0.260           0.082   COD
234 2024-01 internet_fm_ratio     0.578           0.075   COD
235 2023-01        mobile_men     1.000           0.078   FRA
236 2023-01 internet_fm_ratio     1.000           0.083   FRA
237 2023-01    internet_women     0.970           0.090   FRA
238 2023-01      internet_men     0.976           0.088   FRA
239 2023-01   mobile_fm_ratio     1.000           0.066   FRA
240 2023-01      mobile_women     1.000           0.086   FRA
241 2023-02      mobile_women     1.000           0.086   FRA
242 2023-02        mobile_men     1.000           0.078   FRA
243 2023-02 internet_fm_ratio     1.000           0.083   FRA
244 2023-02    internet_women     0.971           0.090   FRA
245 2023-02      internet_men     0.978           0.088   FRA
246 2023-02   mobile_fm_ratio     1.000           0.066   FRA
247 2023-03        mobile_men     1.000           0.078   FRA
248 2023-03      mobile_women     1.000           0.086   FRA
249 2023-03   mobile_fm_ratio     1.000           0.066   FRA
250 2023-03      internet_men     0.980           0.088   FRA
251 2023-03    internet_women     0.972           0.090   FRA
252 2023-03 internet_fm_ratio     1.000           0.083   FRA
253 2023-04 internet_fm_ratio     1.000           0.083   FRA
254 2023-04        mobile_men     1.000           0.078   FRA
255 2023-04      mobile_women     1.000           0.086   FRA
256 2023-04   mobile_fm_ratio     1.000           0.066   FRA
257 2023-04      internet_men     0.983           0.088   FRA
258 2023-04    internet_women     0.975           0.090   FRA
259 2023-05      mobile_women     1.000           0.086   FRA
260 2023-05        mobile_men     1.000           0.078   FRA
261 2023-05    internet_women     0.977           0.090   FRA
262 2023-05 internet_fm_ratio     1.000           0.083   FRA
263 2023-05      internet_men     0.984           0.088   FRA
264 2023-05   mobile_fm_ratio     1.000           0.066   FRA
265 2023-06 internet_fm_ratio     1.000           0.083   FRA
266 2023-06   mobile_fm_ratio     1.000           0.066   FRA
267 2023-06    internet_women     0.962           0.090   FRA
268 2023-06      internet_men     0.954           0.088   FRA
269 2023-06      mobile_women     1.000           0.086   FRA
270 2023-06        mobile_men     0.980           0.078   FRA
271 2023-07 internet_fm_ratio     1.000           0.083   FRA
272 2023-07    internet_women     0.940           0.090   FRA
273 2023-07      mobile_women     1.000           0.086   FRA
274 2023-07   mobile_fm_ratio     1.000           0.066   FRA
275 2023-07      internet_men     0.936           0.088   FRA
276 2023-07        mobile_men     0.979           0.078   FRA
277 2023-08      internet_men     0.935           0.088   FRA
278 2023-08 internet_fm_ratio     1.000           0.083   FRA
279 2023-08        mobile_men     0.979           0.078   FRA
280 2023-08      mobile_women     1.000           0.086   FRA
281 2023-08   mobile_fm_ratio     1.000           0.066   FRA
282 2023-08    internet_women     0.939           0.090   FRA
283 2023-09 internet_fm_ratio     1.000           0.083   FRA
284 2023-09    internet_women     0.957           0.090   FRA
285 2023-09      internet_men     0.968           0.088   FRA
286 2023-09   mobile_fm_ratio     1.000           0.066   FRA
287 2023-09      mobile_women     1.000           0.086   FRA
288 2023-09        mobile_men     1.000           0.078   FRA
289 2023-10 internet_fm_ratio     1.000           0.083   FRA
290 2023-10   mobile_fm_ratio     1.000           0.066   FRA
291 2023-10      mobile_women     1.000           0.086   FRA
292 2023-10      internet_men     0.974           0.088   FRA
293 2023-10        mobile_men     1.000           0.078   FRA
294 2023-10    internet_women     0.966           0.090   FRA
295 2023-11      internet_men     0.953           0.088   FRA
296 2023-11    internet_women     0.943           0.090   FRA
297 2023-11 internet_fm_ratio     1.000           0.083   FRA
298 2023-11   mobile_fm_ratio     1.000           0.066   FRA
299 2023-11      mobile_women     1.000           0.086   FRA
300 2023-11        mobile_men     1.000           0.078   FRA
301 2023-12        mobile_men     1.000           0.078   FRA
302 2023-12      mobile_women     1.000           0.086   FRA
303 2023-12   mobile_fm_ratio     1.000           0.066   FRA
304 2023-12      internet_men     0.952           0.088   FRA
305 2023-12    internet_women     0.941           0.090   FRA
306 2023-12 internet_fm_ratio     1.000           0.083   FRA
307 2024-01      mobile_women     1.000           0.086   FRA
308 2024-01        mobile_men     1.000           0.078   FRA
309 2024-01   mobile_fm_ratio     1.000           0.066   FRA
310 2024-01      internet_men     0.981           0.088   FRA
311 2024-01    internet_women     0.971           0.090   FRA
312 2024-01 internet_fm_ratio     1.000           0.083   FRA
313 2023-01      mobile_women     0.767           0.074   IND
314 2023-01 internet_fm_ratio     0.650           0.072   IND
315 2023-01    internet_women     0.508           0.078   IND
316 2023-01      internet_men     0.686           0.076   IND
317 2023-01   mobile_fm_ratio     0.804           0.057   IND
318 2023-01        mobile_men     0.959           0.067   IND
319 2023-02        mobile_men     0.958           0.067   IND
320 2023-02 internet_fm_ratio     0.651           0.072   IND
321 2023-02    internet_women     0.508           0.078   IND
322 2023-02      internet_men     0.686           0.076   IND
323 2023-02   mobile_fm_ratio     0.804           0.057   IND
324 2023-02      mobile_women     0.767           0.074   IND
325 2023-03      mobile_women     0.775           0.074   IND
326 2023-03        mobile_men     0.964           0.067   IND
327 2023-03   mobile_fm_ratio     0.809           0.057   IND
328 2023-03      internet_men     0.692           0.076   IND
329 2023-03    internet_women     0.513           0.078   IND
330 2023-03 internet_fm_ratio     0.658           0.072   IND
331 2023-04        mobile_men     0.977           0.067   IND
332 2023-04 internet_fm_ratio     0.673           0.072   IND
333 2023-04      mobile_women     0.791           0.074   IND
334 2023-04   mobile_fm_ratio     0.818           0.057   IND
335 2023-04      internet_men     0.706           0.076   IND
336 2023-04    internet_women     0.524           0.078   IND
337 2023-05        mobile_men     0.988           0.067   IND
338 2023-05    internet_women     0.532           0.078   IND
339 2023-05      internet_men     0.717           0.076   IND
340 2023-05 internet_fm_ratio     0.684           0.072   IND
341 2023-05   mobile_fm_ratio     0.825           0.057   IND
342 2023-05      mobile_women     0.804           0.074   IND
343 2023-06 internet_fm_ratio     0.688           0.072   IND
344 2023-06      internet_men     0.721           0.076   IND
345 2023-06   mobile_fm_ratio     0.828           0.057   IND
346 2023-06      mobile_women     0.809           0.074   IND
347 2023-06        mobile_men     0.992           0.067   IND
348 2023-06    internet_women     0.535           0.078   IND
349 2023-07 internet_fm_ratio     0.637           0.072   IND
350 2023-07    internet_women     0.495           0.078   IND
351 2023-07      mobile_women     0.748           0.074   IND
352 2023-07   mobile_fm_ratio     0.796           0.057   IND
353 2023-07      internet_men     0.669           0.076   IND
354 2023-07        mobile_men     0.941           0.067   IND
355 2023-08    internet_women     0.495           0.078   IND
356 2023-08        mobile_men     0.940           0.067   IND
357 2023-08      mobile_women     0.747           0.074   IND
358 2023-08   mobile_fm_ratio     0.795           0.057   IND
359 2023-08      internet_men     0.668           0.076   IND
360 2023-08 internet_fm_ratio     0.636           0.072   IND
361 2023-09 internet_fm_ratio     0.639           0.072   IND
362 2023-09    internet_women     0.496           0.078   IND
363 2023-09      internet_men     0.669           0.076   IND
364 2023-09   mobile_fm_ratio     0.797           0.057   IND
365 2023-09      mobile_women     0.748           0.074   IND
366 2023-09        mobile_men     0.941           0.067   IND
367 2023-10        mobile_men     0.966           0.067   IND
368 2023-10      mobile_women     0.779           0.074   IND
369 2023-10 internet_fm_ratio     0.664           0.072   IND
370 2023-10    internet_women     0.516           0.078   IND
371 2023-10   mobile_fm_ratio     0.813           0.057   IND
372 2023-10      internet_men     0.694           0.076   IND
373 2023-11      internet_men     0.642           0.076   IND
374 2023-11    internet_women     0.475           0.078   IND
375 2023-11 internet_fm_ratio     0.613           0.072   IND
376 2023-11        mobile_men     0.914           0.067   IND
377 2023-11      mobile_women     0.716           0.074   IND
378 2023-11   mobile_fm_ratio     0.781           0.057   IND
379 2023-12      mobile_women     0.719           0.074   IND
380 2023-12        mobile_men     0.916           0.067   IND
381 2023-12 internet_fm_ratio     0.616           0.072   IND
382 2023-12    internet_women     0.477           0.078   IND
383 2023-12      internet_men     0.644           0.076   IND
384 2023-12   mobile_fm_ratio     0.782           0.057   IND
385 2024-01   mobile_fm_ratio     0.804           0.057   IND
386 2024-01      internet_men     0.691           0.076   IND
387 2024-01        mobile_men     0.948           0.067   IND
388 2024-01      mobile_women     0.760           0.074   IND
389 2024-01    internet_women     0.519           0.078   IND
390 2024-01 internet_fm_ratio     0.654           0.072   IND
391 2023-01        mobile_men     0.981           0.077   JPN
392 2023-01 internet_fm_ratio     0.905           0.082   JPN
393 2023-01    internet_women     0.863           0.089   JPN
394 2023-01      internet_men     0.895           0.086   JPN
395 2023-01   mobile_fm_ratio     0.961           0.065   JPN
396 2023-01      mobile_women     0.938           0.084   JPN
397 2023-02      internet_men     0.896           0.086   JPN
398 2023-02 internet_fm_ratio     0.903           0.082   JPN
399 2023-02    internet_women     0.863           0.089   JPN
400 2023-02        mobile_men     0.981           0.077   JPN
401 2023-02   mobile_fm_ratio     0.959           0.065   JPN
402 2023-02      mobile_women     0.937           0.084   JPN
403 2023-03 internet_fm_ratio     0.901           0.082   JPN
404 2023-03      mobile_women     0.937           0.084   JPN
405 2023-03   mobile_fm_ratio     0.958           0.065   JPN
406 2023-03      internet_men     0.896           0.086   JPN
407 2023-03    internet_women     0.863           0.089   JPN
408 2023-03        mobile_men     0.981           0.077   JPN
409 2023-04      mobile_women     0.937           0.084   JPN
410 2023-04 internet_fm_ratio     0.900           0.082   JPN
411 2023-04    internet_women     0.864           0.089   JPN
412 2023-04      internet_men     0.896           0.086   JPN
413 2023-04   mobile_fm_ratio     0.958           0.065   JPN
414 2023-04        mobile_men     0.981           0.077   JPN
415 2023-05      internet_men     0.897           0.086   JPN
416 2023-05   mobile_fm_ratio     0.959           0.065   JPN
417 2023-05 internet_fm_ratio     0.902           0.082   JPN
418 2023-05      mobile_women     0.938           0.084   JPN
419 2023-05    internet_women     0.864           0.089   JPN
420 2023-05        mobile_men     0.982           0.077   JPN
421 2023-06 internet_fm_ratio     0.903           0.082   JPN
422 2023-06      internet_men     0.897           0.086   JPN
423 2023-06   mobile_fm_ratio     0.960           0.065   JPN
424 2023-06      mobile_women     0.939           0.084   JPN
425 2023-06        mobile_men     0.982           0.077   JPN
426 2023-06    internet_women     0.865           0.089   JPN
427 2023-07    internet_women     0.857           0.089   JPN
428 2023-07      mobile_women     0.931           0.084   JPN
429 2023-07 internet_fm_ratio     0.896           0.082   JPN
430 2023-07      internet_men     0.889           0.086   JPN
431 2023-07   mobile_fm_ratio     0.955           0.065   JPN
432 2023-07        mobile_men     0.976           0.077   JPN
433 2023-08      internet_men     0.889           0.086   JPN
434 2023-08 internet_fm_ratio     0.895           0.082   JPN
435 2023-08        mobile_men     0.976           0.077   JPN
436 2023-08      mobile_women     0.930           0.084   JPN
437 2023-08   mobile_fm_ratio     0.954           0.065   JPN
438 2023-08    internet_women     0.857           0.089   JPN
439 2023-09 internet_fm_ratio     0.895           0.082   JPN
440 2023-09    internet_women     0.857           0.089   JPN
441 2023-09      internet_men     0.889           0.086   JPN
442 2023-09   mobile_fm_ratio     0.954           0.065   JPN
443 2023-09      mobile_women     0.930           0.084   JPN
444 2023-09        mobile_men     0.976           0.077   JPN
445 2023-10        mobile_men     0.979           0.077   JPN
446 2023-10 internet_fm_ratio     0.896           0.082   JPN
447 2023-10    internet_women     0.860           0.089   JPN
448 2023-10      mobile_women     0.933           0.084   JPN
449 2023-10   mobile_fm_ratio     0.955           0.065   JPN
450 2023-10      internet_men     0.893           0.086   JPN
451 2023-11      internet_men     0.884           0.086   JPN
452 2023-11    internet_women     0.852           0.089   JPN
453 2023-11 internet_fm_ratio     0.887           0.082   JPN
454 2023-11        mobile_men     0.972           0.077   JPN
455 2023-11      mobile_women     0.924           0.084   JPN
456 2023-11   mobile_fm_ratio     0.950           0.065   JPN
457 2023-12      mobile_women     0.924           0.084   JPN
458 2023-12        mobile_men     0.972           0.077   JPN
459 2023-12 internet_fm_ratio     0.886           0.082   JPN
460 2023-12    internet_women     0.852           0.089   JPN
461 2023-12      internet_men     0.884           0.086   JPN
462 2023-12   mobile_fm_ratio     0.949           0.065   JPN
463 2024-01   mobile_fm_ratio     0.955           0.065   JPN
464 2024-01      internet_men     0.908           0.086   JPN
465 2024-01        mobile_men     0.980           0.077   JPN
466 2024-01      mobile_women     0.935           0.084   JPN
467 2024-01    internet_women     0.876           0.089   JPN
468 2024-01 internet_fm_ratio     0.898           0.082   JPN
469 2023-01 internet_fm_ratio     0.665           0.075   NGA
470 2023-01        mobile_men     0.801           0.070   NGA
471 2023-01      mobile_women     0.664           0.077   NGA
472 2023-01   mobile_fm_ratio     0.821           0.059   NGA
473 2023-01      internet_men     0.489           0.079   NGA
474 2023-01    internet_women     0.371           0.081   NGA
475 2023-02    internet_women     0.373           0.081   NGA
476 2023-02        mobile_men     0.803           0.070   NGA
477 2023-02      mobile_women     0.666           0.077   NGA
478 2023-02   mobile_fm_ratio     0.822           0.059   NGA
479 2023-02      internet_men     0.491           0.079   NGA
480 2023-02 internet_fm_ratio     0.666           0.075   NGA
481 2023-03      internet_men     0.498           0.079   NGA
482 2023-03        mobile_men     0.808           0.070   NGA
483 2023-03      mobile_women     0.672           0.077   NGA
484 2023-03   mobile_fm_ratio     0.825           0.059   NGA
485 2023-03 internet_fm_ratio     0.671           0.075   NGA
486 2023-03    internet_women     0.378           0.081   NGA
487 2023-04 internet_fm_ratio     0.679           0.075   NGA
488 2023-04        mobile_men     0.817           0.070   NGA
489 2023-04      mobile_women     0.683           0.077   NGA
490 2023-04   mobile_fm_ratio     0.831           0.059   NGA
491 2023-04      internet_men     0.511           0.079   NGA
492 2023-04    internet_women     0.389           0.081   NGA
493 2023-05   mobile_fm_ratio     0.834           0.059   NGA
494 2023-05        mobile_men     0.824           0.070   NGA
495 2023-05      mobile_women     0.691           0.077   NGA
496 2023-05    internet_women     0.396           0.081   NGA
497 2023-05 internet_fm_ratio     0.685           0.075   NGA
498 2023-05      internet_men     0.519           0.079   NGA
499 2023-06        mobile_men     0.826           0.070   NGA
500 2023-06 internet_fm_ratio     0.687           0.075   NGA
501 2023-06    internet_women     0.399           0.081   NGA
502 2023-06      internet_men     0.522           0.079   NGA
503 2023-06   mobile_fm_ratio     0.836           0.059   NGA
504 2023-06      mobile_women     0.693           0.077   NGA
505 2023-07      internet_men     0.502           0.079   NGA
506 2023-07        mobile_men     0.811           0.070   NGA
507 2023-07    internet_women     0.381           0.081   NGA
508 2023-07      mobile_women     0.674           0.077   NGA
509 2023-07   mobile_fm_ratio     0.825           0.059   NGA
510 2023-07 internet_fm_ratio     0.670           0.075   NGA
511 2023-08        mobile_men     0.811           0.070   NGA
512 2023-08 internet_fm_ratio     0.671           0.075   NGA
513 2023-08    internet_women     0.381           0.081   NGA
514 2023-08      internet_men     0.502           0.079   NGA
515 2023-08   mobile_fm_ratio     0.825           0.059   NGA
516 2023-08      mobile_women     0.674           0.077   NGA
517 2023-09 internet_fm_ratio     0.673           0.075   NGA
518 2023-09        mobile_men     0.813           0.070   NGA
519 2023-09      mobile_women     0.677           0.077   NGA
520 2023-09   mobile_fm_ratio     0.827           0.059   NGA
521 2023-09      internet_men     0.505           0.079   NGA
522 2023-09    internet_women     0.383           0.081   NGA
523 2023-10      mobile_women     0.688           0.077   NGA
524 2023-10 internet_fm_ratio     0.682           0.075   NGA
525 2023-10   mobile_fm_ratio     0.833           0.059   NGA
526 2023-10      internet_men     0.516           0.079   NGA
527 2023-10    internet_women     0.393           0.081   NGA
528 2023-10        mobile_men     0.822           0.070   NGA
529 2023-11      internet_men     0.498           0.079   NGA
530 2023-11        mobile_men     0.808           0.070   NGA
531 2023-11      mobile_women     0.671           0.077   NGA
532 2023-11   mobile_fm_ratio     0.824           0.059   NGA
533 2023-11    internet_women     0.378           0.081   NGA
534 2023-11 internet_fm_ratio     0.669           0.075   NGA
535 2023-12        mobile_men     0.810           0.070   NGA
536 2023-12    internet_women     0.381           0.081   NGA
537 2023-12      mobile_women     0.675           0.077   NGA
538 2023-12   mobile_fm_ratio     0.828           0.059   NGA
539 2023-12      internet_men     0.501           0.079   NGA
540 2023-12 internet_fm_ratio     0.675           0.075   NGA
541 2024-01 internet_fm_ratio     0.697           0.075   NGA
542 2024-01   mobile_fm_ratio     0.841           0.059   NGA
543 2024-01      mobile_women     0.696           0.077   NGA
544 2024-01        mobile_men     0.824           0.070   NGA
545 2024-01    internet_women     0.413           0.081   NGA
546 2024-01      internet_men     0.534           0.079   NGA
547 2023-01 internet_fm_ratio     0.911           0.079   SAU
548 2023-01        mobile_men     1.000           0.073   SAU
549 2023-01      mobile_women     1.000           0.081   SAU
550 2023-01   mobile_fm_ratio     0.970           0.062   SAU
551 2023-01      internet_men     1.000           0.083   SAU
552 2023-01    internet_women     0.918           0.085   SAU
553 2023-02    internet_women     0.919           0.085   SAU
554 2023-02        mobile_men     1.000           0.073   SAU
555 2023-02      mobile_women     1.000           0.081   SAU
556 2023-02   mobile_fm_ratio     0.971           0.062   SAU
557 2023-02      internet_men     1.000           0.083   SAU
558 2023-02 internet_fm_ratio     0.912           0.079   SAU
559 2023-03    internet_women     0.927           0.085   SAU
560 2023-03        mobile_men     1.000           0.073   SAU
561 2023-03      mobile_women     1.000           0.081   SAU
562 2023-03   mobile_fm_ratio     0.976           0.062   SAU
563 2023-03      internet_men     1.000           0.083   SAU
564 2023-03 internet_fm_ratio     0.920           0.079   SAU
565 2023-04        mobile_men     1.000           0.073   SAU
566 2023-04      mobile_women     1.000           0.081   SAU
567 2023-04   mobile_fm_ratio     0.988           0.062   SAU
568 2023-04      internet_men     1.000           0.083   SAU
569 2023-04    internet_women     0.943           0.085   SAU
570 2023-04 internet_fm_ratio     0.940           0.079   SAU
571 2023-05        mobile_men     1.000           0.073   SAU
572 2023-05    internet_women     0.953           0.085   SAU
573 2023-05 internet_fm_ratio     0.953           0.079   SAU
574 2023-05      internet_men     1.000           0.083   SAU
575 2023-05   mobile_fm_ratio     0.996           0.062   SAU
576 2023-05      mobile_women     1.000           0.081   SAU
577 2023-06        mobile_men     1.000           0.073   SAU
578 2023-06 internet_fm_ratio     0.957           0.079   SAU
579 2023-06    internet_women     0.957           0.085   SAU
580 2023-06      internet_men     1.000           0.083   SAU
581 2023-06   mobile_fm_ratio     0.999           0.062   SAU
582 2023-06      mobile_women     1.000           0.081   SAU
583 2023-07 internet_fm_ratio     0.906           0.079   SAU
584 2023-07    internet_women     0.912           0.085   SAU
585 2023-07      internet_men     1.000           0.083   SAU
586 2023-07   mobile_fm_ratio     0.967           0.062   SAU
587 2023-07      mobile_women     1.000           0.081   SAU
588 2023-07        mobile_men     1.000           0.073   SAU
589 2023-08 internet_fm_ratio     0.904           0.079   SAU
590 2023-08      internet_men     1.000           0.083   SAU
591 2023-08   mobile_fm_ratio     0.966           0.062   SAU
592 2023-08      mobile_women     1.000           0.081   SAU
593 2023-08        mobile_men     1.000           0.073   SAU
594 2023-08    internet_women     0.911           0.085   SAU
595 2023-09 internet_fm_ratio     0.906           0.079   SAU
596 2023-09        mobile_men     1.000           0.073   SAU
597 2023-09      mobile_women     1.000           0.081   SAU
598 2023-09   mobile_fm_ratio     0.967           0.062   SAU
599 2023-09      internet_men     1.000           0.083   SAU
600 2023-09    internet_women     0.912           0.085   SAU
601 2023-10        mobile_men     1.000           0.073   SAU
602 2023-10      mobile_women     1.000           0.081   SAU
603 2023-10    internet_women     0.934           0.085   SAU
604 2023-10      internet_men     1.000           0.083   SAU
605 2023-10   mobile_fm_ratio     0.983           0.062   SAU
606 2023-10 internet_fm_ratio     0.932           0.079   SAU
607 2023-11   mobile_fm_ratio     0.951           0.062   SAU
608 2023-11      internet_men     0.993           0.083   SAU
609 2023-11      mobile_women     1.000           0.081   SAU
610 2023-11 internet_fm_ratio     0.882           0.079   SAU
611 2023-11        mobile_men     1.000           0.073   SAU
612 2023-11    internet_women     0.890           0.085   SAU
613 2023-12        mobile_men     1.000           0.073   SAU
614 2023-12      mobile_women     1.000           0.081   SAU
615 2023-12   mobile_fm_ratio     0.956           0.062   SAU
616 2023-12      internet_men     1.000           0.083   SAU
617 2023-12 internet_fm_ratio     0.889           0.079   SAU
618 2023-12    internet_women     0.896           0.085   SAU
619 2024-01   mobile_fm_ratio     0.981           0.062   SAU
620 2024-01 internet_fm_ratio     0.931           0.079   SAU
621 2024-01    internet_women     0.944           0.085   SAU
622 2024-01        mobile_men     1.000           0.073   SAU
623 2024-01      mobile_women     1.000           0.081   SAU
624 2024-01      internet_men     1.000           0.083   SAU
625 2023-01 internet_fm_ratio     1.000           0.083   SWE
626 2023-01        mobile_men     1.000           0.078   SWE
627 2023-01      mobile_women     1.000           0.086   SWE
628 2023-01   mobile_fm_ratio     1.000           0.065   SWE
629 2023-01      internet_men     1.000           0.087   SWE
630 2023-01    internet_women     1.000           0.090   SWE
631 2023-02    internet_women     1.000           0.090   SWE
632 2023-02        mobile_men     1.000           0.078   SWE
633 2023-02      mobile_women     1.000           0.086   SWE
634 2023-02   mobile_fm_ratio     1.000           0.065   SWE
635 2023-02      internet_men     1.000           0.087   SWE
636 2023-02 internet_fm_ratio     1.000           0.083   SWE
637 2023-03 internet_fm_ratio     1.000           0.083   SWE
638 2023-03        mobile_men     1.000           0.078   SWE
639 2023-03      mobile_women     1.000           0.086   SWE
640 2023-03      internet_men     1.000           0.087   SWE
641 2023-03    internet_women     1.000           0.090   SWE
642 2023-03   mobile_fm_ratio     1.000           0.065   SWE
643 2023-04        mobile_men     1.000           0.078   SWE
644 2023-04      mobile_women     1.000           0.086   SWE
645 2023-04   mobile_fm_ratio     1.000           0.065   SWE
646 2023-04      internet_men     1.000           0.087   SWE
647 2023-04    internet_women     1.000           0.090   SWE
648 2023-04 internet_fm_ratio     1.000           0.083   SWE
649 2023-05        mobile_men     1.000           0.078   SWE
650 2023-05    internet_women     1.000           0.090   SWE
651 2023-05      internet_men     1.000           0.087   SWE
652 2023-05 internet_fm_ratio     1.000           0.083   SWE
653 2023-05   mobile_fm_ratio     1.000           0.065   SWE
654 2023-05      mobile_women     1.000           0.086   SWE
655 2023-06        mobile_men     1.000           0.078   SWE
656 2023-06 internet_fm_ratio     1.000           0.083   SWE
657 2023-06    internet_women     1.000           0.090   SWE
658 2023-06      internet_men     1.000           0.087   SWE
659 2023-06   mobile_fm_ratio     1.000           0.065   SWE
660 2023-06      mobile_women     1.000           0.086   SWE
661 2023-07      mobile_women     1.000           0.086   SWE
662 2023-07 internet_fm_ratio     1.000           0.083   SWE
663 2023-07    internet_women     0.997           0.090   SWE
664 2023-07      internet_men     0.993           0.087   SWE
665 2023-07   mobile_fm_ratio     1.000           0.065   SWE
666 2023-07        mobile_men     1.000           0.078   SWE
667 2023-08 internet_fm_ratio     1.000           0.083   SWE
668 2023-08      internet_men     0.996           0.087   SWE
669 2023-08   mobile_fm_ratio     1.000           0.065   SWE
670 2023-08      mobile_women     1.000           0.086   SWE
671 2023-08        mobile_men     1.000           0.078   SWE
672 2023-08    internet_women     0.999           0.090   SWE
673 2023-09 internet_fm_ratio     1.000           0.083   SWE
674 2023-09        mobile_men     1.000           0.078   SWE
675 2023-09      mobile_women     1.000           0.086   SWE
676 2023-09   mobile_fm_ratio     1.000           0.065   SWE
677 2023-09      internet_men     1.000           0.087   SWE
678 2023-09    internet_women     1.000           0.090   SWE
679 2023-10        mobile_men     1.000           0.078   SWE
680 2023-10      mobile_women     1.000           0.086   SWE
681 2023-10    internet_women     1.000           0.090   SWE
682 2023-10      internet_men     1.000           0.087   SWE
683 2023-10   mobile_fm_ratio     1.000           0.065   SWE
684 2023-10 internet_fm_ratio     1.000           0.083   SWE
685 2023-11   mobile_fm_ratio     1.000           0.065   SWE
686 2023-11      internet_men     0.998           0.087   SWE
687 2023-11      mobile_women     1.000           0.086   SWE
688 2023-11 internet_fm_ratio     1.000           0.083   SWE
689 2023-11        mobile_men     1.000           0.078   SWE
690 2023-11    internet_women     0.998           0.090   SWE
691 2023-12 internet_fm_ratio     1.000           0.083   SWE
692 2023-12      mobile_women     1.000           0.086   SWE
693 2023-12   mobile_fm_ratio     1.000           0.065   SWE
694 2023-12      internet_men     0.996           0.087   SWE
695 2023-12        mobile_men     1.000           0.078   SWE
696 2023-12    internet_women     0.995           0.090   SWE
697 2024-01   mobile_fm_ratio     1.000           0.065   SWE
698 2024-01 internet_fm_ratio     1.000           0.083   SWE
699 2024-01    internet_women     1.000           0.090   SWE
700 2024-01        mobile_men     1.000           0.078   SWE
701 2024-01      mobile_women     1.000           0.086   SWE
702 2024-01      internet_men     1.000           0.087   SWE
703 2023-01   mobile_fm_ratio     1.000           0.067   USA
704 2023-01        mobile_men     0.980           0.080   USA
705 2023-01      mobile_women     1.000           0.088   USA
706 2023-01      internet_men     0.977           0.089   USA
707 2023-01    internet_women     1.000           0.092   USA
708 2023-01 internet_fm_ratio     1.000           0.085   USA
709 2023-02    internet_women     1.000           0.092   USA
710 2023-02        mobile_men     0.983           0.080   USA
711 2023-02      mobile_women     1.000           0.088   USA
712 2023-02   mobile_fm_ratio     1.000           0.067   USA
713 2023-02      internet_men     0.979           0.089   USA
714 2023-02 internet_fm_ratio     1.000           0.085   USA
715 2023-03    internet_women     1.000           0.092   USA
716 2023-03        mobile_men     0.984           0.080   USA
717 2023-03      mobile_women     1.000           0.088   USA
718 2023-03   mobile_fm_ratio     1.000           0.067   USA
719 2023-03      internet_men     0.981           0.089   USA
720 2023-03 internet_fm_ratio     1.000           0.085   USA
721 2023-04        mobile_men     0.985           0.080   USA
722 2023-04      mobile_women     1.000           0.088   USA
723 2023-04   mobile_fm_ratio     1.000           0.067   USA
724 2023-04      internet_men     0.985           0.089   USA
725 2023-04    internet_women     1.000           0.092   USA
726 2023-04 internet_fm_ratio     1.000           0.085   USA
727 2023-05        mobile_men     0.984           0.080   USA
728 2023-05    internet_women     1.000           0.092   USA
729 2023-05      internet_men     0.986           0.089   USA
730 2023-05 internet_fm_ratio     1.000           0.085   USA
731 2023-05   mobile_fm_ratio     1.000           0.067   USA
732 2023-05      mobile_women     1.000           0.088   USA
733 2023-06        mobile_men     0.984           0.080   USA
734 2023-06 internet_fm_ratio     1.000           0.085   USA
735 2023-06    internet_women     1.000           0.092   USA
736 2023-06      internet_men     0.987           0.089   USA
737 2023-06   mobile_fm_ratio     1.000           0.067   USA
738 2023-06      mobile_women     1.000           0.088   USA
739 2023-07      mobile_women     1.000           0.088   USA
740 2023-07   mobile_fm_ratio     1.000           0.067   USA
741 2023-07      internet_men     0.980           0.089   USA
742 2023-07    internet_women     1.000           0.092   USA
743 2023-07        mobile_men     0.999           0.080   USA
744 2023-07 internet_fm_ratio     1.000           0.085   USA
745 2023-08   mobile_fm_ratio     1.000           0.067   USA
746 2023-08      mobile_women     1.000           0.088   USA
747 2023-08        mobile_men     0.999           0.080   USA
748 2023-08    internet_women     1.000           0.092   USA
749 2023-08      internet_men     0.979           0.089   USA
750 2023-08 internet_fm_ratio     1.000           0.085   USA
751 2023-09      internet_men     0.980           0.089   USA
752 2023-09        mobile_men     0.999           0.080   USA
753 2023-09      mobile_women     1.000           0.088   USA
754 2023-09   mobile_fm_ratio     1.000           0.067   USA
755 2023-09    internet_women     1.000           0.092   USA
756 2023-09 internet_fm_ratio     1.000           0.085   USA
757 2023-10    internet_women     1.000           0.092   USA
758 2023-10 internet_fm_ratio     1.000           0.085   USA
759 2023-10   mobile_fm_ratio     1.000           0.067   USA
760 2023-10        mobile_men     0.992           0.080   USA
761 2023-10      internet_men     0.985           0.089   USA
762 2023-10      mobile_women     1.000           0.088   USA
763 2023-11      internet_men     0.978           0.089   USA
764 2023-11    internet_women     0.999           0.092   USA
765 2023-11 internet_fm_ratio     1.000           0.085   USA
766 2023-11      mobile_women     1.000           0.088   USA
767 2023-11   mobile_fm_ratio     1.000           0.067   USA
768 2023-11        mobile_men     1.000           0.080   USA
769 2023-12        mobile_men     1.000           0.080   USA
770 2023-12      mobile_women     1.000           0.088   USA
771 2023-12   mobile_fm_ratio     1.000           0.067   USA
772 2023-12      internet_men     0.979           0.089   USA
773 2023-12 internet_fm_ratio     1.000           0.085   USA
774 2023-12    internet_women     1.000           0.092   USA
775 2024-01   mobile_fm_ratio     1.000           0.067   USA
776 2024-01      internet_men     1.000           0.089   USA
777 2024-01    internet_women     1.000           0.092   USA
778 2024-01 internet_fm_ratio     1.000           0.085   USA
779 2024-01        mobile_men     1.000           0.080   USA
780 2024-01      mobile_women     1.000           0.088   USA
781 2023-01   mobile_fm_ratio     1.000           0.066   ZAF
782 2023-01      mobile_women     0.875           0.086   ZAF
783 2023-01      internet_men     0.760           0.088   ZAF
784 2023-01    internet_women     0.728           0.090   ZAF
785 2023-01        mobile_men     0.871           0.078   ZAF
786 2023-01 internet_fm_ratio     0.953           0.083   ZAF
787 2023-02      internet_men     0.759           0.088   ZAF
788 2023-02 internet_fm_ratio     0.954           0.083   ZAF
789 2023-02        mobile_men     0.869           0.078   ZAF
790 2023-02      mobile_women     0.874           0.086   ZAF
791 2023-02   mobile_fm_ratio     1.000           0.066   ZAF
792 2023-02    internet_women     0.729           0.090   ZAF
793 2023-03      internet_men     0.763           0.088   ZAF
794 2023-03 internet_fm_ratio     0.955           0.083   ZAF
795 2023-03        mobile_men     0.871           0.078   ZAF
796 2023-03      mobile_women     0.876           0.086   ZAF
797 2023-03   mobile_fm_ratio     1.000           0.066   ZAF
798 2023-03    internet_women     0.732           0.090   ZAF
799 2023-04        mobile_men     0.876           0.078   ZAF
800 2023-04      mobile_women     0.882           0.086   ZAF
801 2023-04   mobile_fm_ratio     1.000           0.066   ZAF
802 2023-04      internet_men     0.773           0.088   ZAF
803 2023-04    internet_women     0.741           0.090   ZAF
804 2023-04 internet_fm_ratio     0.958           0.083   ZAF
805 2023-05        mobile_men     0.881           0.078   ZAF
806 2023-05 internet_fm_ratio     0.960           0.083   ZAF
807 2023-05    internet_women     0.747           0.090   ZAF
808 2023-05      internet_men     0.781           0.088   ZAF
809 2023-05   mobile_fm_ratio     1.000           0.066   ZAF
810 2023-05      mobile_women     0.887           0.086   ZAF
811 2023-06        mobile_men     0.882           0.078   ZAF
812 2023-06 internet_fm_ratio     0.961           0.083   ZAF
813 2023-06    internet_women     0.749           0.090   ZAF
814 2023-06      internet_men     0.783           0.088   ZAF
815 2023-06   mobile_fm_ratio     1.000           0.066   ZAF
816 2023-06      mobile_women     0.888           0.086   ZAF
817 2023-07 internet_fm_ratio     0.949           0.083   ZAF
818 2023-07    internet_women     0.725           0.090   ZAF
819 2023-07      internet_men     0.759           0.088   ZAF
820 2023-07   mobile_fm_ratio     0.999           0.066   ZAF
821 2023-07      mobile_women     0.875           0.086   ZAF
822 2023-07        mobile_men     0.873           0.078   ZAF
823 2023-08    internet_women     0.724           0.090   ZAF
824 2023-08      internet_men     0.758           0.088   ZAF
825 2023-08   mobile_fm_ratio     0.999           0.066   ZAF
826 2023-08      mobile_women     0.874           0.086   ZAF
827 2023-08        mobile_men     0.872           0.078   ZAF
828 2023-08 internet_fm_ratio     0.948           0.083   ZAF
829 2023-09 internet_fm_ratio     0.949           0.083   ZAF
830 2023-09        mobile_men     0.873           0.078   ZAF
831 2023-09      mobile_women     0.875           0.086   ZAF
832 2023-09   mobile_fm_ratio     1.000           0.066   ZAF
833 2023-09      internet_men     0.760           0.088   ZAF
834 2023-09    internet_women     0.727           0.090   ZAF
835 2023-10   mobile_fm_ratio     1.000           0.066   ZAF
836 2023-10    internet_women     0.739           0.090   ZAF
837 2023-10      mobile_women     0.882           0.086   ZAF
838 2023-10      internet_men     0.772           0.088   ZAF
839 2023-10        mobile_men     0.877           0.078   ZAF
840 2023-10 internet_fm_ratio     0.956           0.083   ZAF
841 2023-11        mobile_men     0.870           0.078   ZAF
842 2023-11      mobile_women     0.870           0.086   ZAF
843 2023-11   mobile_fm_ratio     0.996           0.066   ZAF
844 2023-11      internet_men     0.751           0.088   ZAF
845 2023-11 internet_fm_ratio     0.944           0.083   ZAF
846 2023-11    internet_women     0.717           0.090   ZAF
847 2023-12        mobile_men     0.872           0.078   ZAF
848 2023-12      mobile_women     0.872           0.086   ZAF
849 2023-12   mobile_fm_ratio     0.997           0.066   ZAF
850 2023-12      internet_men     0.754           0.088   ZAF
851 2023-12 internet_fm_ratio     0.945           0.083   ZAF
852 2023-12    internet_women     0.720           0.090   ZAF
853 2024-01 internet_fm_ratio     0.961           0.083   ZAF
854 2024-01    internet_women     0.753           0.090   ZAF
855 2024-01      internet_men     0.787           0.088   ZAF
856 2024-01        mobile_men     0.881           0.078   ZAF
857 2024-01      mobile_women     0.887           0.086   ZAF
858 2024-01   mobile_fm_ratio     1.000           0.066   ZAF</code></pre>
</div>
</div>
</section>
<section id="visualize-internet-gender-gaps" class="level3">
<h3 class="anchored" data-anchor-id="visualize-internet-gender-gaps">1.3 Visualize internet gender gaps</h3>
<p>In this section, we retrieve the internet female-to-male ratio for all available countries and visualize the results on a world map. By leaving the <code>country</code> parameter unspecified in the API query, we can download data for all available countries at once.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">GET</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="fu">paste0</span>(<span class="st">"http://3.11.85.207/api/v2/download_national_data_with_dates"</span>),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">query =</span> <span class="fu">list</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_date =</span> <span class="st">"2025-01"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_date =</span> <span class="st">"2025-01"</span>    <span class="co">#Will return all countries if country is not specified</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse the response from the API as a list</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">content</span>(response, <span class="at">as =</span> <span class="st">"parsed"</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that we now have three levels instead of two: country → date → indicator </span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>world_data <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">names</span>(data), <span class="cf">function</span>(country) {</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  country_data <span class="ot">&lt;-</span> data[[country]]</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop over all available dates for this country</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(<span class="fu">names</span>(country_data), <span class="cf">function</span>(date) {</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    indicators <span class="ot">&lt;-</span> country_data[[date]]</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Loop over all indicators (e.g., mobile_fm_ratio, internet_men)</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_dfr</span>(<span class="fu">names</span>(indicators), <span class="cf">function</span>(ind) {</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>      entry <span class="ot">&lt;-</span> indicators[[ind]]</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Always return a row, use NA for missing values</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>(</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">gid_0 =</span> country,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">date =</span> date,</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">indicator =</span> ind,</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">predicted =</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(entry<span class="sc">$</span>predicted)) entry<span class="sc">$</span>predicted <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">predicted_error =</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(entry<span class="sc">$</span>predicted_error)) entry<span class="sc">$</span>predicted_error <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>world_internet_ratio <span class="ot">&lt;-</span> world_data <span class="sc">%&gt;%</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(indicator <span class="sc">==</span> <span class="st">"internet_fm_ratio"</span>)</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Get world map (as sf object)</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>world_sf <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">"medium"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out Antarctica (this is optional)</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>world_sf <span class="ot">&lt;-</span> world_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(iso_a3 <span class="sc">!=</span> <span class="st">"ATA"</span>)</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a><span class="co">#Join with indicator data</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>world_map_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(world_sf, world_internet_ratio, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"iso_a3"</span> <span class="ot">=</span> <span class="st">"gid_0"</span>))</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(world_map_data) <span class="sc">+</span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> predicted), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Internet F/M Ratio"</span>,</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">option =</span> <span class="st">"plasma"</span>,</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"grey90"</span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Internet Female-to-Male Ratio by Country"</span>,</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"January 2025"</span>,</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="st">"center"</span>,</span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tutorial3_dgg_api_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="retrieving-subnational-level-digital-gender-gaps-with-dates" class="level2">
<h2 class="anchored" data-anchor-id="retrieving-subnational-level-digital-gender-gaps-with-dates">2 Retrieving subnational-level digital gender gaps (with dates)</h2>
<p>Having explored national-level digital gender gap estimates, we now turn to the subnational level to gain more granular insights within countries. In this section, we would download subnational DGG estimates from the web API. The subnational requests are very similar to those used for national data; however, there are some key differences to keep in mind:</p>
<ol type="1">
<li>We would use a different URL.</li>
<li>Use the argument <code>region</code> and GADM1 codes instead of <code>country</code>.argument.</li>
<li>The response has a 4-level json structure: <code>country → region → date → indicator</code></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">GET</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="fu">paste0</span>(<span class="st">"http://3.11.85.207/api/v2/download_subnational_data_with_dates"</span>),</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">query =</span> <span class="fu">list</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_date =</span> <span class="st">"2024-01"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_date =</span> <span class="st">"2024-01"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">region =</span> <span class="st">"AFG.10_1"</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">content</span>(response, <span class="at">as =</span> <span class="st">"parsed"</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>egy_df <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">names</span>(data), <span class="cf">function</span>(country) {</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  country_data <span class="ot">&lt;-</span> data[[country]]</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(<span class="fu">names</span>(country_data), <span class="cf">function</span>(gadm1) {</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    region_data <span class="ot">&lt;-</span> country_data[[gadm1]]</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_dfr</span>(<span class="fu">names</span>(region_data), <span class="cf">function</span>(date) {</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>      indicators <span class="ot">&lt;-</span> region_data[[date]]</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">map_dfr</span>(<span class="fu">names</span>(indicators), <span class="cf">function</span>(ind) {</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        entry <span class="ot">&lt;-</span> indicators[[ind]]</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">data.frame</span>(</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">gid_0 =</span> country,</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">gid_1 =</span> gadm1,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">date =</span> date,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">indicator =</span> ind,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">predicted =</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(entry<span class="sc">$</span>predicted)) entry<span class="sc">$</span>predicted <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">predicted_error =</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(entry<span class="sc">$</span>predicted_error)) entry<span class="sc">$</span>predicted_error <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>egy_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  gid_0    gid_1    date         indicator predicted predicted_error
1   AFG AFG.10_1 2024-01      mobile_women     0.224           0.101
2   AFG AFG.10_1 2024-01        mobile_men     0.630           0.048
3   AFG AFG.10_1 2024-01   mobile_fm_ratio     0.358           0.101
4   AFG AFG.10_1 2024-01    internet_women     0.088           0.058
5   AFG AFG.10_1 2024-01      internet_men     0.299           0.087
6   AFG AFG.10_1 2024-01 internet_fm_ratio     0.164           0.129</code></pre>
</div>
</div>
</section>
<section id="linking-digital-gender-gap-estimates-with-external-data-sources" class="level2">
<h2 class="anchored" data-anchor-id="linking-digital-gender-gap-estimates-with-external-data-sources">3 Linking digital gender gap estimates with external data sources</h2>
<p>It’s possible to link digital gender gap estimates with external dataset using geographic identifier: ISO3 country code and GADM1 subnational unit code. We can study the substantive topics related to digital inequalities by doing this.</p>
<p>Firstly, we retrieve subnational dgg estimates for all countries with web API. Since parsing the response from API may take a long time, you can also directly read the file instead.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Read the file directly if parsing takes a long time, as we need subnational predictions for all years and all units.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="do">##full_subantional &lt;- read_csv("full_subnational_predictions.csv")</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">GET</span>(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="fu">paste0</span>(<span class="st">"http://3.11.85.207/api/v2/download_subnational_data_with_dates"</span>),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">query =</span> <span class="fu">list</span>(</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_date =</span> <span class="st">"2015-01"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_date =</span> <span class="st">"2025-01"</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">content</span>(response, <span class="at">as =</span> <span class="st">"parsed"</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>full_subantional <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">names</span>(data), <span class="cf">function</span>(country) {</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  country_data <span class="ot">&lt;-</span> data[[country]]</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(<span class="fu">names</span>(country_data), <span class="cf">function</span>(gadm1) {</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    region_data <span class="ot">&lt;-</span> country_data[[gadm1]]</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_dfr</span>(<span class="fu">names</span>(region_data), <span class="cf">function</span>(date) {</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>      indicators <span class="ot">&lt;-</span> region_data[[date]]</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">map_dfr</span>(<span class="fu">names</span>(indicators), <span class="cf">function</span>(ind) {</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>        entry <span class="ot">&lt;-</span> indicators[[ind]]</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">data.frame</span>(</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">gid_0 =</span> country,</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">gid_1 =</span> gadm1,</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">date =</span> date,</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">indicator =</span> ind,</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">predicted =</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(entry<span class="sc">$</span>predicted)) entry<span class="sc">$</span>predicted <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">predicted_error =</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(entry<span class="sc">$</span>predicted_error)) entry<span class="sc">$</span>predicted_error <span class="cf">else</span> <span class="cn">NA</span>,</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a><span class="do">##Calculate mean predictions for each year</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>int_ratio_subnational <span class="ot">&lt;-</span> full_subantional <span class="sc">%&gt;%</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(indicator <span class="sc">==</span> <span class="st">"internet_fm_ratio"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(date, <span class="dv">1</span>, <span class="dv">4</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, gid_0, gid_1, indicator) <span class="sc">%&gt;%</span></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_pred =</span> <span class="fu">mean</span>(predicted, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'gid_0', 'gid_1'. You can override
using the `.groups` argument.</code></pre>
</div>
</div>
<p>Our team has prepared auxiliary datasets to support analysis of relationships between digital gender gaps and other subnational indicators. The first dataset, <strong><code>cgfr_10</code></strong>, provides the Cross-Gender Friendship Rate based on the top-10 friends identified in online social network data, brodied by the <a href="https://data.humdata.org/dataset/cross-gender-ties">Humanitarian Data Exchange</a>. The second dataset comprises selected <a href="https://spatialdata.dhsprogram.com/data/#/">Demographic and Health Survey (DHS)</a> subnational indicators, including:</p>
<ul>
<li><p><code>EDEDUCWSEH</code>: Percentage of women with secondary or higher education</p></li>
<li><p><code>EDLITRWLIT</code>: Percentage of women who are literate</p></li>
<li><p><code>FPCUSMWMOD</code>: Percentage of currently married or in-union women currently using any modern method of contraception</p></li>
<li><p><code>MAAAFMWM2B</code>: Median age at first marriage or union (in years) among women aged 25–49</p></li>
</ul>
<p>Together, these datasets offer a chance for exploring the relationship between digital gender gaps and broader patterns of women’s social network, empowerment and demographic behaviour. However, the DHS indicators are only available for countries that have conducted a DHS survey and have adopted GADM1 as their subnational administrative division. As a result, coverage may be limited and we have to be cautious on the generalizability of analytical results.</p>
<p>We combine dgg estimates and external data by GADM1 code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>cgfr_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"cgfr_indicators.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1915 Columns: 2
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): gid_1
dbl (1): cgfr_10

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>dhs_subnational <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"dhs_subantional_indicators.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 240 Columns: 8
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): GID_0, GID_1, NAME_1
dbl (5): EDEDUCWSEH, EDLITRWLIT, FPCUSMWMOD, MAAAFMWM2B, SVYYEAR

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">##As CGFR is unlikely to change substantially with time, we link them with the newest dgg estimates.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>cgfr_analysis <span class="ot">&lt;-</span> int_ratio_subnational <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2025</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cgfr_data, <span class="at">by =</span> <span class="st">"gid_1"</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="do">##DHS survey indicators are time-sensitive.</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>dhs_analysis <span class="ot">&lt;-</span> int_ratio_subnational <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(dhs_subnational, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"gid_1"</span> <span class="ot">=</span> <span class="st">"GID_1"</span>, <span class="st">"year"</span> <span class="ot">=</span> <span class="st">"SVYYEAR"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(NAME_1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="is-internet-gender-gap-related-to-womans-contraception-use" class="level3">
<h3 class="anchored" data-anchor-id="is-internet-gender-gap-related-to-womans-contraception-use">3.1 Is internet gender gap related to woman’s contraception use?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dhs_analysis, <span class="fu">aes</span>(<span class="at">x =</span> FPCUSMWMOD, <span class="at">y =</span> mean_pred)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"#54278f"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"#f768a1"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(<span class="at">method =</span> <span class="st">"pearson"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">label.y =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Percentage of Women Using Modern Method of Contraception"</span>,  </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Internet Female-to-Male Ratio"</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tutorial3_dgg_api_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercise-1" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1">3.3 Exercise 1</h3>
<ol type="1">
<li>How can we retrieve <strong>subnational female internet adoption levels</strong> from the DGG web API?</li>
<li>Which of the DHS subnational indicators appears to be most strongly associated with female internet adoption levels?</li>
</ol>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>